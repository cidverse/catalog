workflows:
  - name: main
    rules: []
    stages:
      - name: build
        actions:
          - id: central/go-build
            config:
              # cross-platform build
              platform:
                - goos: windows
                  goarch: amd64
                - goos: linux
                  goarch: amd64
                - goos: darwin
                  goarch: amd64
          - id: central/java-build
          - id: central/python-build
          - id: central/node-build
          - id: central/hugo-build
          - id: central/helm-build
          - id: central/mkdocs-build
          - id: central/techdocs-build
          #- id: central/test-action
      - name: test
        actions:
          - id: central/go-test
          - id: central/java-test
          - id: central/helm-test
      - name: package
        actions:
          - id: central/upx-optimize
          - id: central/buildah-build
            config:
              no-cache: false
              squash: true
              rebuild: true
      - name: scan
        actions:
          - id: central/go-lint-golangci
          - id: central/python-lint
          - id: central/helm-lint
          #- id: central/gitleaks-scan
          - id: central/semgrep-scan
          #- id: central/fossa-source-scan
          - id: central/sonarqube-scan
          - id: central/syft-container-sbom-scan
      - name: publish
        actions:
          # container - publish to registry
          - id: central/buildah-publish
          # java library - publish
          - id: central/java-publish
          # container - sign image
          #- id: central/cosign-container-sign
          # container - attach and sign sbom
          #- id: central/cosign-container-sbom-attach
          # helm chart - publish - nexus
          - id: central/helm-publish-nexus
          # docs - techdocs - publish
          - id: central/techdocs-publish
          # changelog
          - id: central/changelog-generate
          # release - github
          - id: central/github-release-publish
