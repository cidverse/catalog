workflows:
- name: main
  version: 0.1.0
  description: |
    The `main` workflow is the default workflow in `CID` if no workflow name is provided.

    It contains the following stages, with conditional actions based on the project type.
  rules: []
  stages:
    - name: build
      actions:
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+go-build
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+gradle-build
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+maven-build
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+dotnet-build
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+python-build
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+node-build
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+hugo-build
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+helm-build
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+mkdocs-build
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+techdocs-build
    - name: test
      actions:
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+go-test
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+gradle-test
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+maven-test
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+dotnet-test
    - name: lint
      actions:
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+ansible-lint
        #- id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+python-lint
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+helm-lint
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+helmfile-lint
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+renovate-lint
    - name: package
      actions:
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+upx-optimize
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+buildah-build
          config:
            no-cache: false
            squash: true
            rebuild: true
    - name: scan
      actions:
        #- id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+ossf-scorecard-scan
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+gitleaks-scan
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+semgrep-scan
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+trivyfs-scan
        #- id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+fossa-source-scan
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+sonarqube-scan
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+qodana-scan
        #- id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+syft-artifact-sbom-generate
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+syft-container-sbom-generate
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+zizmor-scan
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+github-sarif-upload
    - name: publish
      actions:
        # container - publish to registry
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+buildah-publish
        # java library - publish
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+gradle-publish
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+maven-publish
        # container - sign image
        #- id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+cosign-container-sign
        # container - attach and sign sbom
        #- id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+cosign-container-sbom-attach
        # helm charts
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+helm-publish-nexus
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+helm-publish-registry
        # docs - techdocs - publish
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+techdocs-publish
        # changelog
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+changelog-generate
        # release
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+github-release-publish
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+gitlab-release-publish
    - name: deploy
      actions:
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+ansible-deploy
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+helm-deploy
        - id: container://ghcr.io/cidverse/cid-actions-go:0.1.0+helmfile-deploy
